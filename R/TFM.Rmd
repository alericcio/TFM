---
title: "TFM"
author: "Alessio Riccioli"
date: "10/9/2018"
output:
  html_document: default
  word_document: default
---

```{r include=TRUE}
rm(list=ls())
DCO = read.csv("DCO.csv", header = FALSE)
GRD = read.csv("GRD.csv", header = FALSE)
patologia = read.csv("patologia.csv", header = FALSE)
servicios = read.csv("Servicios.csv", header = FALSE)
colnames(DCO) <- c("id","DCO", "Description")
colnames(GRD) <- c("id","GRD", "Description")
colnames(patologia) <- c("id","N_historia", "Gender", "Edad", "Fec_Serv", "S_ingreso", "S_alta", "GRD", "Severidad", "Version_Grd", "Cdm", "Peso_Grd", "DCO")
colnames(servicios) <- c("id","serv", "description")

```
<div style="text-align: justify"> Los GRD, o Grupos Relacionados por el Diagnóstico, son una herramienta de gestión normalizadora,en la que mediante un programa inform??tico, alimentado con los datos de los pacientes dados de alta hospitalaria el Conjunto M??nimo B??sico de Datos (CMBD), podemos clasificar a los pacientes en grupos clínicamente similares y con parecido consumo de recursos sanitarios.
CDM significa Categoría diagnóstica mayor.
Los GRD son un sistema de clasificación de pacientes por sistema de ajustes de riesgos con base en el isoconsumo de recursos. Sirven para conocer la casu??stica de un hospital, el case mix hospitalario. Son muy útiles en la gestión y financiación de hospitales. Los GRD es un sistema de clasificación de pacientes que clasifica a los pacientes hospitalarios
en grupos homogéneos en cuanto al consumo de recursos.
Las CDM (o grandes capítulos en que se agrupan los GRD) se suelen ajustar a los grandes aparatos o sistemas corporales. Son las 26 siguientes: </div>

* PreCDM. Contiene una serie de GRD especiales.
* CDM 1. Enfermedades y trastornos del sistema nervioso.
* CDM 2. Enfermedades y trastornos del ojo.
* CDM 3. Enfermedades y trastornos del oído, nariz y boca.
* CDM 4. Enfermedades y trastornos del aparato respiratorio.
* CDM 5. Enfermedades y trastornos del aparato circulatorio.
* CDM 6. Enfermedades y trastornos del aparato digestivo.
* CDM 7. Enfermedades y trastornos del higado, sistema biliar y p??ncreas.
* CDM 8. Enfermedades y trastornos del sistema musculoesquelético y tejido conectivo.
* CDM 9. Enfermedades y trastornos de la piel, del tejido subcutáneo y de la mama.
* CDM 10. Enfermedades y trastornos endocrinos, nutricionales y metab??licos.
* CDM 11. Enfermedades y trastornos del riñón y vías urinarias.
* CDM 12. Enfermedades y trastornos del aparato reproductor masculino.
* CDM 13. Enfermedades y trastornos del aparato reproductor feminino.
* CDM 14. Embarazo, parto y puerperio.
* CDM 15. Recién nacidos y cuadros del periodo neonatal.
* CDM 16. Enfermedades y trastornos de sangre, sistema hematopoyético e inmunitario.
* CDM 17. Enfermedades y trastornos mieloproliferativos y neoplasias poco diferenciadas.
* CDM 18. Enfermedades infecciosas y parasitarias
* CDM 19. Enfermedades o trastornos mentales.
* CDM 20. Consumo alcohol/drogas y trastornos orgánicos mentales inducidos por drogas.
* CDM 21. Heridas, envenenamientos y efectos tóxicos de las drogas.
* CDM 22. Quemaduras.
* CDM 23. Factores que influyen en el estado de salud y otros contactos con servicios sanitarios.
* CDM 24. Infecciones por el Virus de la Inmunodeficiencia Humana.
* CDM 25. Politraumatismos importantes.

```{r include=TRUE}
summary(patologia)
dim(DCO)
dim(GRD)
dim(patologia)
dim(servicios)

barplot(table(patologia$Edad)) # gráfico que muestra la distribución de los ingresos según la edad

hist(patologia$Edad, probability = TRUE)

# Número de filas en la tabla patologia
nrows = nrow(patologia)
# Identifo diferencias entre S_ingreso y S_alta
y <- matrix(nrow = nrows, ncol = 1)
for (i in 1:nrows){
  if ( patologia[i, 6] == patologia[i, 7] ) {
    y[i,]<- "igual"
  } else {
    y[i,]<- "distinto"
  }
}
summary(y) # Hay 6338 iguales y 37813 casos distintos

primermerge <- merge(patologia, GRD, by = "GRD", all = TRUE)
segundomerge <- merge(primermerge, DCO, by = "DCO", all = TRUE)
patologia_limpio <- subset(segundomerge, select = -c(N_historia, S_ingreso, S_alta, Version_Grd, Cdm, Peso_Grd, id.y, id))
colnames(patologia_limpio)[colnames(patologia_limpio)=="Description.x"] <- "Descripcion_GRD"
colnames(patologia_limpio)[colnames(patologia_limpio)=="Description.y"] <- "Descripcion_DCO"
colnames(patologia_limpio)[colnames(patologia_limpio)=="id.x"] <- "id"
```
